{"template" : "{  \"aggs\": {    \"1\": {       \"nested\": {         \"path\": \"role.party\"       },       \"aggs\": {         \"partySearchFilter\": {           \"filter\": {             \"bool\": {              \"should\": [ {\"nested\": {\"path\": \"role.party.identification\" , \"query\": {\"bool\": {\"should\": [    {     \"match\": {   \"_type\": \"nomatch\"   }    } {{#identification}} ,    {       \"match\": {     \"role.party.identification.identifier\": {      \"query\": \"{{.}}\",      \"operator\": \"and\"   }    }  } {{/identification}} ] , \"minimum_should_match\": 1 } } } } ,  {\"nested\": {\"path\": \"role.party.account\" , \"query\": {\"bool\": {\"should\": [    {     \"match\": {   \"_type\": \"nomatch\"   }    } {{#account}} ,    {       \"match\": {     \"role.party.account.number\": {      \"query\": \"{{.}}\",      \"operator\": \"and\"   }    }  } {{/account}} ] , \"minimum_should_match\": 1 } } } } ,  {\"nested\": {\"path\": \"role.party.name\" , \"query\": {\"bool\": {\"should\": [    {     \"match\": {   \"_type\": \"nomatch\"   }    } {{#name}} ,    {       \"match\": {     \"role.party.name.fullName\": {      \"query\": \"{{.}}\",      \"operator\": \"and\"   }    }  } {{/name}} ] , \"minimum_should_match\": 1 } } } } ,  {\"nested\": {\"path\": \"role.party.address\" , \"query\": {\"bool\": {\"should\": [    {     \"match\": {   \"_type\": \"nomatch\"   }    } {{#address}} ,    {       \"match\": {     \"role.party.address.streetAddress\": {      \"query\": \"{{.}}\",      \"operator\": \"and\"   }    }  } {{/address}} ] , \"minimum_should_match\": 1 } } } }              ] , \"minimum_should_match\" : {{token_matches}}{{^token_matches}}1{{/token_matches}}}          },          \"aggs\": {            \"1\": {              \"nested\": {                \"path\": \"role.party.name\"               },            \"aggs\": {                \"nameDetails\": {                  \"terms\": {                    \"field\": \"role.party.name.fullName.keyword\",                    \"missing\": \"missing\"                   }                }              }            },\"2\": {              \"nested\": {                \"path\": \"role.party.address\"               },    \"aggs\": {                \"nameDetails\": {                  \"terms\": {                    \"field\": \"role.party.address.streetAddress.keyword\",                    \"missing\": \"missing\"                   }                }              }            },\"3\": {              \"nested\": {                \"path\": \"role.party.account\"               },    \"aggs\": {                \"accountDetails\": {                  \"terms\": {                    \"field\": \"role.party.account.number\",                    \"missing\": 0                   }                }              }            },\"4\": {              \"nested\": {                \"path\": \"role.party.identification\"               },    \"aggs\": {                \"identificationDetails\": {                  \"terms\": {                    \"field\": \"role.party.identification.identifier.keyword\",                    \"missing\": 0                   }                }              }            }          }        }      }}},\"size\": 0}"
}
